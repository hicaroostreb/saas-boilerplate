#!/usr/bin/env sh

echo "ğŸš€ Running pre-push checks..."

# Check for commits to push
unpushed_commits=$(git log @{u}..HEAD --oneline 2>/dev/null | wc -l)
if [ "$unpushed_commits" -eq 0 ]; then
    echo "â„¹ï¸  No commits to push"
    exit 0
fi

echo "ğŸ“Š Pushing $unpushed_commits commit(s)..."

# Full project validation before push
bun run qa:build

if [ $? -eq 0 ]; then
    echo "âœ… Pre-push checks passed!"
    echo "ğŸš€ Ready to push"
else
    echo ""
    echo "âŒ Pre-push checks failed"
    echo "ğŸ’¡ Run 'bun run qa:fix' to resolve issues"
    exit 1
fi