#!/usr/bin/env sh

echo "🚀 Running pre-push checks..."

# Check for commits to push
unpushed_commits=$(git log @{u}..HEAD --oneline 2>/dev/null | wc -l)
if [ "$unpushed_commits" -eq 0 ]; then
    echo "ℹ️  No commits to push"
    exit 0
fi

echo "📊 Pushing $unpushed_commits commit(s)..."

# Full project validation before push
bun run qa:build

if [ $? -eq 0 ]; then
    echo "✅ Pre-push checks passed!"
    echo "🚀 Ready to push"
else
    echo ""
    echo "❌ Pre-push checks failed"
    echo "💡 Run 'bun run qa:fix' to resolve issues"
    exit 1
fi